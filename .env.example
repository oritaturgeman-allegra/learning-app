# Capital Market Newsletter - Environment Configuration
# Copy this file to .env and fill in the required values
#
# Legend:
#   REQUIRED - Must be set for the application to start
#   Required if X - Required only when using feature X
#   Optional - Has sensible defaults, override if needed

# ==============================================================================
# REQUIRED VARIABLES
# ==============================================================================

# REQUIRED: OpenAI API key (must start with "sk-")
# Get yours at: https://platform.openai.com/api-keys
OPENAI_API_KEY=sk-your-openai-api-key-here

# ==============================================================================
# LLM & TTS CONFIGURATION
# ==============================================================================

# LLM Provider: "openai" or "gemini" (default: openai)
LLM_PROVIDER=openai

# Required if LLM_PROVIDER=gemini or TTS_PROVIDER=gemini
# Get yours at: https://aistudio.google.com/apikey
GEMINI_API_KEY=

# OpenAI model for text analysis (default: gpt-4o-mini)
OPENAI_MODEL=gpt-4o-mini

# Gemini model for text analysis (default: gemini-2.0-flash)
GEMINI_MODEL=gemini-2.0-flash

# TTS Provider: "openai" or "gemini" (default: openai)
TTS_PROVIDER=openai

# OpenAI TTS model (default: tts-1-hd)
TTS_MODEL=tts-1-hd

# Gemini TTS model (default: gemini-2.5-flash-preview-tts)
GEMINI_TTS_MODEL=gemini-2.5-flash-preview-tts

# OpenAI TTS voices
TTS_VOICE_ALEX=nova
TTS_VOICE_GUY=onyx

# Gemini TTS voices
GEMINI_VOICE_ALEX=Aoede
GEMINI_VOICE_GUY=Orus

# ==============================================================================
# DATABASE CONFIGURATION
# ==============================================================================

# Database connection URL
#
# SQLite (local development):
#   DATABASE_URL=sqlite:///data/newsletter.db
#
# Supabase PostgreSQL (production):
#   Get connection string from: Supabase Dashboard > Settings > Database > Connection string
#   Format: postgresql://postgres.[project-ref]:[password]@aws-0-[region].pooler.supabase.com:6543/postgres
#
# IMPORTANT: Use the "Transaction pooler" connection string (port 6543) for best performance
# Add ?sslmode=require for secure connections
#
DATABASE_URL=sqlite:///data/newsletter.db

# Enable SQL query logging for debugging (default: false)
SQL_ECHO=false

# Optional: Supabase project credentials (for future features like realtime)
# Get from: Supabase Dashboard > Settings > API
SUPABASE_URL=
SUPABASE_ANON_KEY=

# ==============================================================================
# SERVER SETTINGS
# ==============================================================================

# Server host binding (default: 0.0.0.0)
FLASK_HOST=0.0.0.0

# Server port (default: 5000)
FLASK_PORT=5000

# Enable debug mode - NEVER enable in production (default: false)
FLASK_DEBUG=false

# Base URL for email verification links (default: http://localhost:5000)
BASE_URL=http://localhost:5000

# ==============================================================================
# FEED PROCESSING
# ==============================================================================

# RSS feed fetch timeout in seconds (default: 10)
FEED_TIMEOUT=10

# Maximum concurrent feed fetches (default: 5)
FEED_MAX_WORKERS=5

# Hours window for "recent" articles (default: 6)
INTRADAY_HOURS=6

# Maximum articles per category in newsletter (default: 5)
MAX_ARTICLES_PER_CATEGORY=5

# ==============================================================================
# CACHE SETTINGS
# ==============================================================================

# Newsletter cache TTL in seconds (default: 21600 = 6 hours)
# Should match or exceed scheduler gaps to avoid extra LLM calls
NEWSLETTER_CACHE_TTL=21600

# Audio/podcast cache TTL in seconds (default: 86400 = 24 hours)
# Must be long enough to cover scheduler gaps (up to 15h overnight)
AUDIO_CACHE_TTL=86400

# ==============================================================================
# GOOGLE OAUTH (Required for user authentication)
# ==============================================================================

# Required if using Google OAuth login
# Get credentials at: https://console.cloud.google.com/apis/credentials
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=

# OAuth callback URL (must match Google Console configuration)
GOOGLE_REDIRECT_URI=http://localhost:5000/api/auth/google/callback

# ==============================================================================
# EMAIL SERVICE (Required for email verification)
# ==============================================================================

# SendGrid API key for sending emails
# Get yours at: https://app.sendgrid.com/settings/api_keys
EMAIL_API_KEY=

# Sender email address (must be verified in SendGrid)
EMAIL_FROM_ADDRESS=yournewsletter.yourway@gmail.com

# Sender display name
EMAIL_FROM_NAME=Your Newsletter, Your Way

# Email verification token expiration in hours (default: 24)
VERIFICATION_TOKEN_TTL_HOURS=24

# ==============================================================================
# SCHEDULER SETTINGS
# ==============================================================================

# Enable scheduled content generation (default: true)
SCHEDULE_ENABLED=true

# Hours (UTC) to generate content, comma-separated (default: 11,14,18,20)
SCHEDULE_HOURS_UTC=11,14,18,20

# Scheduler timezone (default: UTC)
SCHEDULE_TIMEZONE=UTC

# Grace period for missed jobs in seconds (default: 900 = 15 minutes)
SCHEDULE_MISFIRE_GRACE_TIME=900

# ==============================================================================
# ADMIN & SECURITY
# ==============================================================================

# API key for admin endpoints (e.g., /api/admin/refresh)
# Generate a secure random string for production
ADMIN_API_KEY=

# Force HTTPS redirect and enable HSTS (default: false)
# Enable in production with proper SSL certificate
FORCE_HTTPS=false

# Use Content-Security-Policy-Report-Only for testing (default: true)
# Set to false in production after testing CSP rules
CSP_REPORT_ONLY=true

# ==============================================================================
# CORS SETTINGS (For external clients/mobile apps)
# ==============================================================================

# Enable CORS middleware (default: false)
CORS_ENABLED=false

# Allowed origins, comma-separated (empty = no cross-origin allowed)
# Example: https://app.example.com,https://mobile.example.com
CORS_ORIGINS=

# Allow credentials (cookies/auth headers) in cross-origin requests (default: true)
CORS_ALLOW_CREDENTIALS=true

# ==============================================================================
# SENTRY ERROR MONITORING (Optional but recommended for production)
# ==============================================================================

# Sentry DSN for error monitoring (empty = disabled)
# Get yours at: https://sentry.io
SENTRY_DSN=

# Environment name: development | staging | production
SENTRY_ENVIRONMENT=development

# Fraction of transactions to trace (0.0-1.0, default: 0.1)
SENTRY_TRACES_SAMPLE_RATE=0.1

# ==============================================================================
# LOGGING
# ==============================================================================

# Log format: "text" for development, "json" for production (default: text)
LOG_FORMAT=text

# Log level: DEBUG | INFO | WARNING | ERROR (default: INFO)
LOG_LEVEL=INFO

# ==============================================================================
# RATE LIMITING
# ==============================================================================

# Enable rate limiting for auth endpoints (default: true)
RATE_LIMIT_ENABLED=true

# Login: max attempts and window in seconds
RATE_LIMIT_LOGIN_MAX=5
RATE_LIMIT_LOGIN_WINDOW=900

# Signup: max attempts and window in seconds
RATE_LIMIT_SIGNUP_MAX=3
RATE_LIMIT_SIGNUP_WINDOW=3600

# Resend verification: max attempts and window in seconds
RATE_LIMIT_RESEND_MAX=3
RATE_LIMIT_RESEND_WINDOW=3600
